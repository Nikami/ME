<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bbcode test</title>
  <link type="text/css" rel="stylesheet" href="style.css">
</head>
<body>
<!--[chronics]
&lt;!&ndash; Ссылка на отыгрыш &ndash;&gt;
[quest=https://code.jquery.com/jquery-2.2.4.min.js]
&lt;!&ndash; Название &ndash;&gt;
[title]Титул[/title]
&lt;!&ndash; Временной промежуток, выбираем одно из значений:
fb - флешбек
me1 - Mass Effect 2183-2184г.
me2 - Mass Effect 2 2185г.
me - Mass Effect 3 2186г&ndash;&gt;
[period]me1[/period]
&lt;!&ndash;Статус квест, одно из значений:
 a - активен
 c - завершен
 x - закрыт
 &ndash;&gt;
[status]a[/status]
&lt;!&ndash; Краткое описание &ndash;&gt;
[desc]Обырг[/desc]
&lt;!&ndash; Внешний вид &ndash;&gt;
[appearance]Внешка[/appearance]
&lt;!&ndash; Инвентарь/арсенал &ndash;&gt;
[arsenal]Арсек[/arsenal]
&lt;!&ndash; Соигроки &ndash;&gt;
[players]Джон[/players]
[/quest]
[/chronics]-->
<textarea id="main-reply">
  [chronics]
    [quest]
      [title]Most Wanted[/title]
      [src]http://masseffectfromashes.ru/click.php?http://masseffectfromashes.ru/viewtopic.php?id=6650[/src]
      [period]me1[/period]
      [status]a[/status]
      [desc]Группа гонконгcких налётчиков безнаказанно грабит грузовики корпорации "Синкай Груп", одного из негласных поставщиков оружия и военной электроники для "Цербера". Не имея официальной лицензии на предпринимательскую деятельность на Земле, "Цербер" первым ощущает на себе последствия методично спланированного разбоя.[/desc]
      [arsenal][url="http://masseffectfromashes.ru/click.php?http://sportbolid.ru/upload/content/55f2db8814f82.jpg"]Lamborghini Aventador[/url], М-6 "Палач", армейский нож, инструментрон + резотрон, сигареты, зажигалка.[/arsenal]
      [appearance]Черная кожаная куртка с закатанными по локоть рукавами (видно тату), под низом белая футболка, темное серые джинсы и ботинки на высокой шнуровке.[/appearance]
      [players]Lisa[/players]
    [/quest]
    [quest]
      [title]Эпизод 7.6 [Deceit. Distraction. And a big fucking army][/title]
      [src]http://masseffectfromashes.ru/click.php?http://masseffectfromashes.ru/viewtopic.php?id=6453[/src]
      [period]me2[/period]
      [status]a[/status]
      [desc]После того, как база Коллекционеров была уничтожена, прошло уже немало времени. За ретранслятором Омега-4 находятся исследовательские корабли "Цербера", разбирая останки базы, работая на своего босса. Ария Т'Лоак знает об этом и не возражает - до тех пор, пока на Омеге не разворачивается целая война. Королеве Омеги придется защищать свою территорию любыми средствами.[/desc]
      [arsenal]M-13 "Хищник", М-6 "Палач", армейский нож, инструментрон + резотрон, устройство управления адъютантами[/arsenal]
      [appearance][url="http://masseffectfromashes.ru/click.php?https://s-media-cache-ak0.pinimg.com/236x/f7/9a/95/f79a95ed45e1fdaa59796388ffa19e85.jpg"]граждаснкая одежда, глубокий капюшон плаща и черный визор скрывают лицо.[/url][/appearance]
      [players]Triz Hesse, Nyreen Kandros, Aria T'Loak, Micky Arrn[/players]
    [/quest]
    [quest]
      [title]Эпизод 9.1-3 [Издержки][/title]
      [src]http://masseffectfromashes.ru/click.php?http://masseffectfromashes.ru/viewtopic.php?id=6453[/src]
      [period]me2[/period]
      [status]x[/status]
      [desc]После того, как база Коллекционеров была уничтожена, прошло уже немало времени. За ретранслятором Омега-4 находятся исследовательские корабли "Цербера", разбирая останки базы, работая на своего босса. Ария Т'Лоак знает об этом и не возражает - до тех пор, пока на Омеге не разворачивается целая война. Королеве Омеги придется защищать свою территорию любыми средствами.[/desc]
      [arsenal]M-13 "Хищник", М-6 "Палач", армейский нож, инструментрон + резотрон.[/arsenal]
      [appearance][url=http://masseffectfromashes.ru/click.php?http://images.vg247.com/current//2011/04/Vector.jpg]Cредняя броня "Цербера"[/url][/appearance]
      [players]Lisa, Katerina Otto, Hunk, Jessica Bryce, Rose Carter, Salt[/players]
    [/quest]
    [quest]
      [title]Эпизод 9.3 [Город грехов][/title]
      [src]http://masseffectfromashes.ru/click.php?http://masseffectfromashes.rolka.su/viewtopic.php?id=6841[/src]
      [period]me3[/period]
      [status]c[/status]
      [desc]После того, как база Коллекционеров была уничтожена, прошло уже немало времени. За ретранслятором Омега-4 находятся исследовательские корабли "Цербера", разбирая останки базы, работая на своего босса. Ария Т'Лоак знает об этом и не возражает - до тех пор, пока на Омеге не разворачивается целая война. Королеве Омеги придется защищать свою территорию любыми средствами.[/desc]
      [arsenal]M-13 "Хищник", М-6 "Палач", армейский нож, инструментрон + резотрон, шокер, пистолет с тринквилизаторами. [/arsenal]
      [appearance][url=http://masseffectfromashes.ru/click.php?http://images.vg247.com/current//2011/04/Vector.jpg]Cредняя броня "Цербера"[/url][/appearance]
      [players]Blizzard, Akira T'Karro, James Vega, Maya Jones, Alexandra Meinem, Sam Rocko[/players]
    [/quest]
  [/chronics]
</textarea>

<!--<div class="chronicle-block">-->
  <!--<div class="chronicle-buttons&#45;&#45;aside">-->
   <!--<div class="chronicle-buttons__button chronicle-buttons__button&#45;&#45;aside chronicle-buttons__button&#45;&#45;closed" data-status="x"><span class="chronicle-buttons__span"></span></div>-->
    <!--<div class="chronicle-buttons__button chronicle-buttons__button&#45;&#45;aside chronicle-buttons__button&#45;&#45;complete" data-status="c"><span class="chronicle-buttons__span"></span></div>-->
    <!--<div class="chronicle-buttons__button chronicle-buttons__button&#45;&#45;aside chronicle-buttons__button&#45;&#45;active" data-status="a"><span class="chronicle-buttons__span"></span></div>-->
  <!--</div>-->
  <!--&lt;!&ndash; КВЕСТЫ &ndash;&gt;-->
  <!--<h4 class="chronicle-quests__title"><span class="chronicle-quests__title-ico"></span>Chronics</h4>-->
  <!--<div class="chronicle-quests">-->
    <!--<ul class="chronicle-quests__missions">-->
      <!--<li class="connecting-span connecting-span&#45;&#45;missions" style="display: none;">Connecting...</li>-->
    <!--</ul>-->
  <!--</div>-->
  <!--&lt;!&ndash; ИНФОРМАЦИЯ ПО КВЕСТУ &ndash;&gt;-->
  <!--<div class="chronicle-info">-->
    <!--&lt;!&ndash; КНОПКИ СОРТИРОВКИ &ndash;&gt;-->
    <!--<div class="chronicle-buttons">-->
      <!--<button class="chronicle-buttons__button chronicle-buttons__primary active" data-period="all">All</button>-->
      <!--<button class="chronicle-buttons__button chronicle-buttons__primary" data-period="fb">Flashback</button>-->
      <!--<button class="chronicle-buttons__button chronicle-buttons__primary" data-period="me1">ME1 [до 2184]</button>-->
      <!--<button class="chronicle-buttons__button chronicle-buttons__primary" data-period="me2">ME2 [2185]</button>-->
      <!--<button class="chronicle-buttons__button chronicle-buttons__primary" data-period="me3">ME3 [2186]</button>-->
    <!--</div>-->
    <!--<div class="chronicle-info-mission chronicle-info-mission&#45;&#45;connecting">-->
      <!--<span class="connecting-span">Connecting...</span>-->
    <!--</div>-->
  <!--</div>-->
<!--</div>-->

<script type="text/javascript" src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
<script type="text/javascript" src="script.js"></script>
<script type="text/javascript">
  var string = $('#main-reply').html();
  var chronics = string.match(constructBbCodeRegEx('chronics'));

  if (chronics) {
    chronics = chronics[0];
    var chronicsFragment = $('<div class="chronicle-block"></div>');
    var chronicsTmpl = '<div class="chronicle-buttons--aside"> <div class="chronicle-buttons__button chronicle-buttons__button--aside chronicle-buttons__button--closed" data-status="x"><span class="chronicle-buttons__span"></span></div><div class="chronicle-buttons__button chronicle-buttons__button--aside chronicle-buttons__button--complete" data-status="c"><span class="chronicle-buttons__span"></span></div><div class="chronicle-buttons__button chronicle-buttons__button--aside chronicle-buttons__button--active" data-status="a"><span class="chronicle-buttons__span"></span></div></div><h4 class="chronicle-quests__title"><span class="chronicle-quests__title-ico"></span>Chronics</h4> <div class="chronicle-quests"> <ul class="chronicle-quests__missions"> <li class="connecting-span connecting-span--missions" style="display: none;">Connecting...</li></ul> </div><div class="chronicle-info"> <div class="chronicle-buttons"> <button class="chronicle-buttons__button chronicle-buttons__primary active" data-period="all">All</button> <button class="chronicle-buttons__button chronicle-buttons__primary" data-period="fb">Flashback</button> <button class="chronicle-buttons__button chronicle-buttons__primary" data-period="me1">ME1 [до 2184]</button> <button class="chronicle-buttons__button chronicle-buttons__primary" data-period="me2">ME2 [2185]</button> <button class="chronicle-buttons__button chronicle-buttons__primary" data-period="me3">ME3 [2186]</button> </div><div class="chronicle-info-mission chronicle-info-mission--connecting"> <span class="connecting-span">Connecting...</span> </div></div>';
    chronicsFragment.html(chronicsTmpl);

    var quests = string.match(constructBbCodeRegEx('quest'));

    for (var i=0; i < quests.length; i++) {

    }

    $('body').append(chronicsFragment);
  }



  function constructBbCodeRegEx(bbcodeName) {
    var regex = '';
    if (bbcodeName) {
      regex = '\\[' + bbcodeName +']((.|\\n)*)?\\[\\/' + bbcodeName +'\\]';
    } else {
      regex = '\\[(.*?)?\\](.*?)\\[\\/(.*?)\\]';
    }
    return new RegExp(regex, 'g');
  }

</script>
</body>
</html>

[code]<!--HTML-->
<style type="text/css">
  .post-content .glossary-container {
    background-color: #434465;
    padding: 20px;
    width: 600px;
    box-shadow: inset 0 0 9px black, 0 0 2px black;
    color: #c1c7e7;
    background: url('http://funkyimg.com/i/2gpFo.jpg') top center !important;
    border: 1px solid #878fbc;
    font-size: 11px;
    font-family: verdana;
    text-shadow: 0 0 2px black;
  }

  .post-content .glossary-container a {
    color: #bd68a4;
  }

  .post-content .glossary-container a:hover {
    color: #6875bd;
  }

  .glossary-links-container {
    overflow-y: auto;
    height: 100%;
  }

  .post-content .glossary-main {
    padding-left: 10px !important;
    padding-right: 10px !important;
    background: rgba(131, 125, 164, 0.04);
  }

  .post-content .glossary-relative {
    background-color: #171420;
    position: relative;
    padding: 15px;
    overflow-y: hidden;
    height: 227px;
  }

  .post-content .glossary-relative a {
    color: #6875bd !important;
  }

  .post-content .glossary-relative a:hover {
    color: #bd68a4 !important;
  }

  .post-content .glossary-menu {
    table-collapse: collapse;
    margin: 0 !important;
    width: 100%;
  }

  .post-content .glossary-menu__item {
    background-color: RGBA(112, 122, 185, 0.28);
    border-bottom: 3px solid #171420 !important;
    color: #c1c7e9;
    font-family: Arial, san-serif;
    padding: 15px !important;
    text-transform: uppercase;
    text-align: center;
    transition: 0.3s ease;
  }

  .glossary-menu__item.back {
    background-color: rgba(255, 255, 255, 0);
    border: none !important;
    position: absolute;
    bottom: 5px;
    left: 5px;
    color: #bd68a4;
    display: none;
    padding: 0;
    width: 100px;
  }

  .glossary-menu__item:hover {
    opacity: 0.7;
    cursor: pointer;
  }

  .post-content .glossary-menu__item:first-child {
    border-right: 40px solid #171420 !important;

  }

  .glossary-links-category {
    display: none;
  }

  .glossary-links-category a {
    display: block;
    text-align: center;
  }

  .glossary-links-category a {
    font-size: 17px;
  }

  .glossary-links-category a:hover {
    opacity: 0.7;
  }
</style>
<div class="glossary-container">
  <p class="glossary-main">

  <p align="right"><font size="1px">Идея взята с форума <a href="http://neopolis.rusff.ru/viewtopic.php?id=964#p68917">Неополис</a>
    с разрешения администрации</align></font></p><br>
  Mass Effect - игра, во вселенной которой есть множество белых пятен, существование которых признано самими
  разработчиками игры. Для того, чтобы ролевая игра на основе этой вселенной имела целостный характер, мы предлагаем вам
  поучаствовать в создании этой темы.<br>
  Суть проста: здесь можно рассказать другим игрокам о каком-то аспекте этого мира, который придумали вы сами во время
  игры или просто так. Это может быть что угодно: торговая марка, популярный сериал, известная на всю галактику
  знаменитость и так далее. <br>
  Сообщения в этой теме проходят модерацию. В конце проверенного и одобренного сообщения появится соответствующая
  печать, а если сообщение модерацию не проходит, то будет удалено.
  <br><br>
  Пример оформления:<br>
  <b>Название</b> - И вся информация о том, о чем хотите рассказать. Представьте, что составляете статью на википедии (:
  <br><br>
  <b>Источник:</b> ссылка на пост, в котором появляется эта информация. Если кусочек лора, о котором вы пишете - полет
  фантазии, а не плод игры, можно этот пункт убрать вовсе.
  </p>
  <div class="glossary-relative">
    <table class="glossary-menu">
      <tr class="glossary-menu__row">
        <td class="glossary-menu__item" data-category="politics" onclick="showGlossaryLinks(this)">Политика и история
        </td>
        <td class="glossary-menu__item" data-category="persons" onclick="showGlossaryLinks(this)">Известные личности
        </td>
      </tr>
      <tr class="glossary-menu__row">
        <td class="glossary-menu__item" data-category="culture" onclick="showGlossaryLinks(this)">Массовая культура</td>
        <td class="glossary-menu__item" data-category="places" onclick="showGlossaryLinks(this)">Места</td>
      </tr>
      <tr class="glossary-menu__row">
        <td class="glossary-menu__item" data-category="home" onclick="showGlossaryLinks(this)">Быт</td>
        <td class="glossary-menu__item" data-category="events" onclick="showGlossaryLinks(this)">Лента происшествий</td>
      </tr>
      <tr class="glossary-menu__col">
        <td class="glossary-menu__item" data-category="technology" onclick="showGlossaryLinks(this)">Технологии</td>
        <td class="glossary-menu__item" data-category="organization" onclick="showGlossaryLinks(this)">Организации</td>
      </tr>
      <tr class="glossary-menu__col">
        <td class="glossary-menu__item" data-category="nature" onclick="showGlossaryLinks(this)">Флора и фауна</td>
        <td class="glossary-menu__item" data-category="galaxy" onclick="showGlossaryLinks(this)">Загадочная галактика
        </td>
      </tr>
    </table>
    <div class="glossary-links-container">
      <div class="glossary-links-category" data-category="politics">
        <a href="#">Ссылка</a>
      </div>
      <div class="glossary-links-category" data-category="persons">
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700180">Уильям "Пегас" Гаст</a>
      </div>
      <div class="glossary-links-category" data-category="culture">
        <a href="#">Ссылка</a>
      </div>
      <div class="glossary-links-category" data-category="places">
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700214">Бар "На конце Вселенной"</a>
      </div>
      <div class="glossary-links-category" data-category="home">
        <a href="#">Ссылка</a>
      </div>
      <div class="glossary-links-category" data-category="events">
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700120">Взрыв на Тессии</a>
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700120">Варфоломеевская ночь</a>
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700120">Процесс над лондонским похитителем</a>
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700120">Трагедия на Гавайях</a>
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700120">Дикари в наше время</a>
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700123">Необычное включение</a>
      </div>
      <div class="glossary-links-category" data-category="technology">
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700140">Турианский челнок LH-14 "Птерос".</a>
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700176">Наркотик "Изумрудные облака"</a>
      </div>
      <div class="glossary-links-category" data-category="organization">
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700102">Компания "Надёжные руки"</a>
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700145">Структура Турианской Армии</a>
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700173">Секта фанатичных ханаров-защитников
          природы на Новерии</a>
      </div>
      <div class="glossary-links-category" data-category="nature">
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700112">Хищник из Сабарика</a>
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700113">Арвунский лев</a>
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700174">Растение-реликт "Времена года"</a>
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700175">Рыба-сюрприз</a>
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700178">Лакримида</a>
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700181">Хищники-невидимки</a>
      </div>
      <div class="glossary-links-category" data-category="galaxy">
        <a href="http://masseffectfromashes.ru/viewtopic.php?id=7025#p700096">Раса Рэлой и Турвесс</a>
      </div>
      <div class="glossary-menu__item back" data-category="back" onclick="showGlossaryLinks(this)">
        << Назад
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  function showGlossaryLinks(el) {
    var currentEl = $(el);
    var category = currentEl.attr('data-category');
    var relative = currentEl.closest('.glossary-relative');
    var menu = relative.find('.glossary-menu');

    relative.find('.active').fadeOut(0).removeClass('.active');

    if (category === 'back') {
      currentEl.css('display', 'none');
      menu.fadeIn(300);
    } else {
      menu.fadeOut(200, function () {
        relative.find('.glossary-menu__item.back').css('display', 'block');
        relative.find('.glossary-links-category[data-category="' + category + '"]').fadeIn(300).addClass('active');
      });
    }
  }
</script>[/code]